#!/usr/bin/env bash

set -euo pipefail

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

#-- Ensure all required packages are installed via Ansible
cd ${DIR}/../ansible/
ansible-playbook playbooks/install_packages.yaml
cd ${DIR}

for app in ${DIR}/../services/* ${DIR}/../apps/*/frontend ${DIR}/../apps/*/backend; do
  if [ -d "${app}" ]; then
    echo $app
    make -C "${app}" bootstrap
  fi
done

pnpm --dir "${DIR}/.." install
