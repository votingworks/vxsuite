#!/usr/bin/env bash

# Generates the saved election package fixtures in libs/fixtures
# By default it will reuse the translations and audio from previous runs if new strings
# are not detected to be translated. To force re-translation, set the environment variable
# FORCE_RETRANSLATE to true.
export NODE_ENV=development

# Check if FORCE_RETRANSLATE is set to true
if [ -z "$FORCE_RETRANSLATE" ]; then
  export FORCE_RETRANSLATE=0
else
  export FORCE_RETRANSLATE=1
fi

# Generate all election packages that should be created multi-language
export REACT_APP_VX_ENABLE_CLOUD_TRANSLATION_AND_SPEECH_SYNTHESIS=TRUE

./bin/generate-election-package ../fixtures/data/electionPrimaryPrecinctSplits $FORCE_RETRANSLATE

# Generate all election packages that should be created single-language
export REACT_APP_VX_ENABLE_CLOUD_TRANSLATION_AND_SPEECH_SYNTHESIS=FALSE

echo
echo "Note: You need to run \`pnpm build:resources && pnpm build\` in libs/fixtures for the new fixtures to register"
